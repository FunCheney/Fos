### 一切皆文件

在 UNIX 操作系统中，”一切皆文件“ (Everything is a file) 是一种重要的设计思想。

应用程序访问的 文件 (File) 就是一系列的字节组合。操作系统管理文件，但操作系统不关心文件内容，只关心如何对文件按字节流进行读写的机制，这就意味
着任何程序可以读写任何文件（即字节流），对文件具体内容的解析是应用程序的任务，操作系统对此不做任何干涉。

有了文件这样的抽象后，操作系统内核就可把能读写的I/O资源按文件来进行管理，并把文件分配给进程，让进程以统一的文件访问接口与I/O 资源进行交互。在目
前和后续可能涉及到的I/O硬件设备中，大致可以分成以下几种：

* 键盘设备: 是程序获得字符输入的一种设备，也可抽象为一种只读性质的文件，可以从这个文件中读出一系列的字节序列；

* 屏幕设备: 是展示程序的字符输出结果的一种字符显示设备，可抽象为一种只写性质的文件，可以向这个文件中写入一系列的字节序列，在显示屏上可以直接呈现出来；

* 串口设备: 是获得字符输入和展示程序的字符输出结果的一种字符通信设备，可抽象为一种可读写性质的文件，可以向这个文件中写入一系列的字节序列传给程序，
  也可把程序要显示的字符传输出去；还可以把这个串口设备拆分成两个文件，一个用于获取输入字符的只读文件和一个传出输出字符的只写文件。


### 对标准输入/输出的管理

应用程序如果要基于文件进行I/O访问，大致就会涉及如下几个操作：

* 打开（open）：进程只有打开文件，操作系统才能返回一个可进行读写的文件描述符给进程，进程才能基于这个值来进行对应文件的读写；

* 关闭（close）：进程基于文件描述符关闭文件后，就不能再对文件进行读写操作了，这样可以在一定程度上保证对文件的合法访问；

* 读（read）：进程可以基于文件描述符来读文件内容到相应内存中；

* 写（write）：进程可以基于文件描述符来把相应内存内容写到文件中；

### 读写标准输入/输出文件

由于有基于文件抽象接口和文件描述符表，之前实现的文件读写系统调用 sys_read/write 可以直接用于标准输入/输出文件，很好地达到了代码重用的目标。 
这样，操作系统通过文件描述符在当前进程的文件描述符表中找到某个文件，无需关心文件具体的类型，只要知道它一定实现了 File Trait 的 read/write 
方法即可。Trait 对象提供的运行时多态能力会在运行的时候帮助我们定位到符合实际类型的 read/write 方法，完成不同类型文件各自的读写。

